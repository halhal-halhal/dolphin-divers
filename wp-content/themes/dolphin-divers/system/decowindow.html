<html>
<head>
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Cache-Control" content="no-cache">
<meta http-equiv="Expires" content="Thu, 01 Dec 1994 16:00:00 GMT">
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<style type="text/css">
<!--
a {
	text-decoration: none;
}
-->
</style>
<script type="text/javascript">
var QS = new Array;
var sourceobj;
if (location.search.length > 1) {
var m_Array = location.search.substr(1).split("&"); 
for (idx in m_Array) {
var str=m_Array[idx]+"";
QS.push(str.split("="));
}
for (idx in QS) {
if(QS[idx][0] == "sourceobj"){sourceobj=QS[idx][1];}
}
}


targetobj = "decoedit";
function decosubmit(){
var r1=0;
var r2=0;
var str = document.getElementById(targetobj).value;
//タグのチェック
//<span ***>の数をチェック
var ret1 = new Array();
ret1 = str.match(/<span/g);
if( ret1 == null ){r1 = 0;}else{r1=ret1.length;}
//<span ***>の数をチェック
var ret2 = new Array(); 
ret2 = str.match(/span>/g);
if( ret2 == null ){r2 = 0;}else{r2=ret2.length;}
//</span>の数をチェック
if( r1 != r2 ){alert("装飾にミスがあります。spanタグをチェックして下さい。\nspanタグは「<span>（装飾する文字）</span>」の対で利用します。どちらかが欠けるとエラーになります。");}else{
window.opener.document.getElementById(sourceobj).value = str;
window.close();
}	//if
}	//func
</script>
</head>

<body>

<form>

<!-- decobuttonシステム -->
<script type="text/javascript" src="decobutton.js"></script>
<table width="840" border="0" cellpadding="8" cellspacing="1" bgcolor="#666666">
<tr>
<td bgcolor="#FFFFFF" align="center">編集欄</td>
<td bgcolor="#FFFFFF" align="center">プレビュー</td>
</tr>
<tr>
<td width="50%" valign="top" bgcolor="#FFFFFF"><textarea name="decoedit" cols="46" rows="20" id="decoedit" ></textarea>
</p></td>
<td width="50%" valign="top" bgcolor="#FFFFFF"><div id="decobuttonpreview"></div></td>
</tr>
<tr>
<td colspan="2" align="center" valign="top" bgcolor="#FFFFFF"><input type="button" name="button" id="button" value="OK" style="width:100px" onClick="decosubmit()" ></td>
</tr>
</table>
<!-- /decobuttonシステム -->

</form>

</body>
</html>
